<!DOCTYPE html>
<html>
<head>
    <!-- Document Settings -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />

    <!-- Base Meta -->
    <!-- dynamically fixing the title for tag/author pages -->



    <title>Building a Minecraft Puppet Scanner with Event Hub, a NFC 522 Reader and a Raspberry PI</title>
    <meta name="HandheldFriendly" content="True" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- Styles'n'Scripts -->
    <link rel="stylesheet" type="text/css" href="/assets/built/screen.css" />
    <link rel="stylesheet" type="text/css" href="/assets/built/screen.edited.css" />
    <!-- highlight.js -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/vs2015.min.css">
    <style>.hljs { background: none; }</style>

    <!-- This tag outputs SEO meta+structured data and other important settings -->
    <meta name="description" content="My thoughts, tutorials and learnings" />
    <link rel="shortcut icon" href="/assets/images/favicon.png" type="image/png" />
    <link rel="canonical" href="/minecraft-rfc-scanner" />
    <meta name="referrer" content="no-referrer-when-downgrade" />

     <!--title below is coming from _includes/dynamic_title-->
    <meta property="og:site_name" content="Xavier Geerinck - Blog" />
    <meta property="og:type" content="website" />
    <meta property="og:title" content="Building a Minecraft Puppet Scanner with Event Hub, a NFC 522 Reader and a Raspberry PI" />
    <meta property="og:description" content="In Belgium we every year celebrate the coming of “Sinterklaas” on the 6th of December, a celebration for children where this mythologic figure delivers presents for all the children that behaved well that year. (see: https://en.wikipedia.org/wiki/Sinterklaas for more information). To follow this tradition, many companies hold internal events where children" />
    <meta property="og:url" content="/minecraft-rfc-scanner" />
    <meta property="og:image" content="/assets/images/covers/minecraft.jpg" />
    <meta property="article:publisher" content="https://www.facebook.com/" />
    <meta property="article:author" content="https://www.facebook.com/" />
    <meta property="article:published_time" content="2018-11-25T09:00:00+00:00" />
    <meta property="article:modified_time" content="2018-11-25T09:00:00+00:00" />
    <meta property="article:tag" content="Coding" />
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Building a Minecraft Puppet Scanner with Event Hub, a NFC 522 Reader and a Raspberry PI" />
    <meta name="twitter:description" content="In Belgium we every year celebrate the coming of “Sinterklaas” on the 6th of December, a celebration for children where this mythologic figure delivers presents for all the children that behaved well that year. (see: https://en.wikipedia.org/wiki/Sinterklaas for more information). To follow this tradition, many companies hold internal events where children" />
    <meta name="twitter:url" content="/" />
    <meta name="twitter:image" content="/assets/images/covers/minecraft.jpg" />
    <meta name="twitter:label1" content="Written by" />
    <meta name="twitter:data1" content="Xavier Geerinck - Blog" />
    <meta name="twitter:label2" content="Filed under" />
    <meta name="twitter:data2" content="Coding" />
    <meta name="twitter:site" content="@XavierGeerinck" />
    <meta name="twitter:creator" content="@XavierGeerinck" />
    <meta property="og:image:width" content="1400" />
    <meta property="og:image:height" content="933" />

    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Website",
    "publisher": {
        "@type": "Organization",
        "name": "Xavier Geerinck - Blog",
        "logo": "/false"
    },
    "url": "/minecraft-rfc-scanner",
    "image": {
        "@type": "ImageObject",
        "url": "/assets/images/covers/minecraft.jpg",
        "width": 2000,
        "height": 666
    },
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "/minecraft-rfc-scanner"
    },
    "description": "In Belgium we every year celebrate the coming of “Sinterklaas” on the 6th of December, a celebration for children where this mythologic figure delivers presents for all the children that behaved well that year. (see: https://en.wikipedia.org/wiki/Sinterklaas for more information). To follow this tradition, many companies hold internal events where children"
}
    </script>

    <meta name="generator" content="Jekyll 3.6.2" />
    <link rel="alternate" type="application/rss+xml" title="Building a Minecraft Puppet Scanner with Event Hub, a NFC 522 Reader and a Raspberry PI" href="/feed.xml" />



    <!-- Enable MathJAX for LaTeX equations -->
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
            tex2jax: {inlineMath: [['$','$'], ['\\(','\\)']]}
        });
        </script>
    <script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?config=TeX-MML-AM_CHTML">
  </script>

</head>
<body class="post-template">

    <div class="site-wrapper">
        <!-- All the main content gets inserted here, index.hbs, post.hbs, etc -->
        <!-- default -->

<!-- The tag above means: insert everything in this file
into the {body} of the default.hbs template -->

<header class="site-header outer">
    <div class="inner">
        <nav class="site-nav">
    <div class="site-nav-left">
        <ul class="nav" role="menu">
    <li class="nav-home" role="menuitem"><a href="/">Home</a></li>
    <li class="nav-about" role="menuitem"><a href="/about/">About</a></li>
    <li class="nav-about" role="menuitem"><a href="/projects">Projects</a></li>
    <li class="nav-about" role="menuitem"><a href="/demos">Demos</a></li>
    <li class="nav-about" role="menuitem"><a href="/categories">Categories</a></li>
</ul>

    </div>
    <div class="site-nav-right">
        <div class="social-links">
            
            
                <a class="social-link social-link-tw" href="https://twitter.com/XavierGeerinck" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg>
</a>
            
            
                <a class="social-link social-link-tw" href="https://linkedin.com/in/xaviergeerinck" target="_blank" rel="noopener"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/></svg></a>
            
        </div>
        
    </div>
</nav>

    </div>
</header>

<!-- Everything inside the #post tags pulls data from the post -->
<!-- #post -->

<main id="site-main" class="site-main outer" role="main">
    <div class="inner">

        <article class="post-full post tag-coding ">

            <header class="post-full-header">
                <section class="post-full-meta">
                    <time class="post-full-meta-date" datetime="25 November 2018">25 November 2018</time>
                    
                        <span class="date-divider">/</span>
                        
                            
                               <a href='/tag/coding/'>CODING</a>,
                            
                        
                            
                               <a href='/tag/coding-javascript/'>CODING-JAVASCRIPT</a>,
                            
                        
                            
                               <a href='/tag/big-data/'>BIG-DATA</a>
                            
                        
                    
                </section>
            </header>

            
            <figure class="post-full-image" style="background-image: url(/assets/images/covers/minecraft.jpg)">
            </figure>
            

            <section class="post-full-content">
                <div class="kg-card-markdown">
                        <h1 class="post-full-title">Building a Minecraft Puppet Scanner with Event Hub, a NFC 522 Reader and a Raspberry PI</h1>
                    <p>In Belgium we every year celebrate the coming of “Sinterklaas” on the 6th of December, a celebration for children where this mythologic figure delivers presents for all the children that behaved well that year. (see: https://en.wikipedia.org/wiki/Sinterklaas for more information). To follow this tradition, many companies hold internal events where children of the employees are invited to participate in all kinds of events. I was asked to participate in one of these events and come up with a workshop for children of all ranges - being divided in 2 groups (the very young ones, and the somewhat older ones).</p>

<h2 id="the-idea">The Idea</h2>

<p>The foundation of any idea starts with finding a base reasoning that will act as a guideline throughout the idea itself. Which in this case was that I want to spike the interest for technology in these childen, so that one day they might be interested in enrolling into technology studies</p>

<blockquote>
  <p>This is also often referred to as STEM (Science, Technology, Engineering and Mathematics). Which is an ongoing initiative world-wide to stimulate children chosing for these education areas</p>
</blockquote>

<p>After some brain storming the idea popped up of creating a sort of game where the children would have to match “dolls” together with “stands” (that all almost look the same) through the use of technology. In this case the technology being a simple nfc-reader that would read the tags under these stands whereafter a message is send to an Event Hub to be able to visualize the messages as a visual on a website. To make this more attractive the “Minecraft” theme was chosen so that every kid would be able to recognize it and think of it as more fun. In this case, the dolls would be Minecraft themed and the stands would be decorated as “redstone ore” blocks.</p>

<h2 id="purchasing-and-assembling-the-needed-material">Purchasing and Assembling the needed material</h2>

<p>So now we have the idea, what is needed to make this a reality?</p>

<ul>
  <li>NFC Reader (In my case a RFID-RC522 reader)</li>
  <li>Raspberry PI</li>
  <li>Jumper Cables</li>
  <li>Breadboard (to be able to connect the reader to the raspberry pi)</li>
  <li>Lego for the stands (let’s go back to being a kid again ;))</li>
  <li>Lego for the puppets</li>
</ul>

<h3 id="purchasing-our-lego">Purchasing our Lego</h3>

<p>After a quick shopping spree on our favorite Webshop together with a quick trip to the Lego store to purchase the material for the stands (a big thanks to the employees in there that helped me find all the material I needed) resulted in some Minecraft boxes and lego components to build everything we need:</p>

<p><strong>Puppets:</strong></p>

<p><img src="/assets/images/posts/minecraft-nfc/lego-box-1.jpg" alt="/assets/images/posts/minecraft-nfc/lego-box-1.jpg" />
<img src="/assets/images/posts/minecraft-nfc/lego-box-2.jpg" alt="/assets/images/posts/minecraft-nfc/lego-box-2.jpg" /></p>

<p><strong>Stand Components:</strong></p>

<p><img src="/assets/images/posts/minecraft-nfc/lego-purchase-1.jpg" alt="/assets/images/posts/minecraft-nfc/lego-purchase-1.jpg" />
<img src="/assets/images/posts/minecraft-nfc/lego-purchase-2.jpg" alt="/assets/images/posts/minecraft-nfc/lego-purchase-2.jpg" />
<img src="/assets/images/posts/minecraft-nfc/lego-purchase-3.jpg" alt="/assets/images/posts/minecraft-nfc/lego-purchase-3.jpg" /></p>

<h3 id="assembling-our-lego-stand">Assembling our Lego Stand</h3>

<p>Now we have our Lego, let’s get started with building our stands for our Minecraft dolls. Here you can find the different steps that I used towards building those stands:</p>

<p><img src="/assets/images/posts/minecraft-nfc/lego-stand-part-1.jpg" alt="/assets/images/posts/minecraft-nfc/lego-stand-part-1.jpg" />
<img src="/assets/images/posts/minecraft-nfc/lego-stand-part-2.jpg" alt="/assets/images/posts/minecraft-nfc/lego-stand-part-2.jpg" />
<img src="/assets/images/posts/minecraft-nfc/lego-stand-part-3.jpg" alt="/assets/images/posts/minecraft-nfc/lego-stand-part-3.jpg" />
<img src="/assets/images/posts/minecraft-nfc/lego-stand-part-4.jpg" alt="/assets/images/posts/minecraft-nfc/lego-stand-part-4.jpg" />
<img src="/assets/images/posts/minecraft-nfc/lego-stand-part-5.jpg" alt="/assets/images/posts/minecraft-nfc/lego-stand-part-5.jpg" /></p>

<p><img src="/assets/images/posts/minecraft-nfc/lego-stand-finished.jpg" alt="/assets/images/posts/minecraft-nfc/lego-stand-finished.jpg" /></p>

<h3 id="soldering-our-nfc-reader">Soldering our NFC Reader</h3>

<p>After purchasing the RFID-255 reader a sharp eye will notice that it comes into a small package with nothing being assembled.</p>

<p><img src="/assets/images/posts/minecraft-nfc/nfc-tags-and-reader.jpg" alt="/assets/images/posts/minecraft-nfc/nfc-tags-and-reader.jpg" /></p>

<p>A quick soldering trip later then resulted in something usable that we can easily stick on a breadboard</p>

<p><img src="/assets/images/posts/minecraft-nfc/nfc-reader-soldering.jpg" alt="/assets/images/posts/minecraft-nfc/nfc-reader-soldering.jpg" />
<img src="/assets/images/posts/minecraft-nfc/nfc-reader-soldering-done.jpg" alt="/assets/images/posts/minecraft-nfc/nfc-reader-soldering-done.jpg" />
<img src="/assets/images/posts/minecraft-nfc/nfc-reader-breadboard.jpg" alt="/assets/images/posts/minecraft-nfc/nfc-reader-breadboard.jpg" /></p>

<h3 id="connecting-the-nfc-reader-to-our-raspberry-pi">Connecting the NFC Reader to our Raspberry PI</h3>

<p>To connect our Raspberry PI reader to the RFID reader that we just soldered above, we need to know the pin layout. Luckily a lot of online documentation is able to provide us something as the layout shown below:</p>

<p><img src="/assets/images/posts/minecraft-nfc/raspberry-pins.png" alt="/assets/images/posts/minecraft-nfc/raspberry-pins.png" /></p>

<p>On here we can read our pin connections:</p>

<table>
  <thead>
    <tr>
      <th>RFID Pin</th>
      <th>Raspberry PI Pin</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>MOSI</td>
      <td>Pin 19 (GPIO10)</td>
    </tr>
    <tr>
      <td>MISO</td>
      <td>Pin 21 (GPIO9)</td>
    </tr>
    <tr>
      <td>SCLK</td>
      <td>Pin 23 (GPIO11)</td>
    </tr>
    <tr>
      <td>SDA</td>
      <td>Pin 24 (GPIO8)</td>
    </tr>
    <tr>
      <td>Reset</td>
      <td>Pin 22 (GPIO25)</td>
    </tr>
    <tr>
      <td>Power</td>
      <td>Pin 1 (3,3 V)</td>
    </tr>
    <tr>
      <td>GND</td>
      <td>Pin 6 (GND)</td>
    </tr>
  </tbody>
</table>

<p>Looking like this when we connect them:</p>

<p><img src="/assets/images/posts/minecraft-nfc/raspberry-connected.jpg" alt="/assets/images/posts/minecraft-nfc/raspberry-connected.jpg" /></p>

<h3 id="enabling-the-spi-interface-on-raspberry-pi">Enabling the SPI Interface on Raspberry PI</h3>

<p>Before we are able to read out our RFID tag, we first need to enable the SPI interface on the Raspberry PI.</p>

<p>To do this we need to log in on the console of the Raspberry PI and run the <code class="highlighter-rouge">sudo raspi-config</code> command. This will open up an interface where we will select <code class="highlighter-rouge">5. Interfacing Options</code> -&gt; <code class="highlighter-rouge">SPI</code> -&gt; <code class="highlighter-rouge">Enable</code>.</p>

<p>Confirm that this is set by running <code class="highlighter-rouge">lsmod | grep spi</code> which should show <code class="highlighter-rouge">spi_bcm2835</code> if everything went correctly. The SPI interface is now enabled.</p>

<h2 id="creating-our-code">Creating our code</h2>

<p>Now everything is connected, the only thing left to do is write the actual code for 2 components that will do several things:</p>

<h3 id="nfc-reader-code">NFC Reader Code</h3>

<p>For our NFC Reader we will be using <code class="highlighter-rouge">Node.js</code> for the program code together with a library called <code class="highlighter-rouge">mfrc522-rpi</code> which will make our lives easier since it allows us to call functions that can easily read the tags for us.</p>

<h4 id="1-detecting-our-nfc-tag">1. Detecting our NFC Tag</h4>

<p>Detecting our NFC Tag can be done through the library mentioned earlier, then we can copy in the tutorial code as mentioned in the library README.md which looks like this:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">//# Init WiringPi with SPI Channel 0</span>
<span class="nx">mfrc522</span><span class="p">.</span><span class="nx">initWiringPi</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span>

<span class="c1">//# This loop keeps checking for chips. If one is near it will get the UID and authenticate</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">scanning...</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Please put chip or keycard in the antenna inductive zone!</span><span class="dl">"</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Press Ctrl-C to stop.</span><span class="dl">"</span><span class="p">);</span>

<span class="nx">setInterval</span><span class="p">(</span><span class="kd">function</span> <span class="p">()</span> <span class="p">{</span> <span class="c1">// Every 2 seconds check if a card is present</span>
    <span class="c1">//# reset card</span>
    <span class="nx">mfrc522</span><span class="p">.</span><span class="nx">reset</span><span class="p">();</span>

    <span class="c1">//# Scan for cards</span>
    <span class="kd">let</span> <span class="nx">response</span> <span class="o">=</span> <span class="nx">mfrc522</span><span class="p">.</span><span class="nx">findCard</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">response</span><span class="p">.</span><span class="nx">status</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Card detected, CardType: </span><span class="dl">"</span> <span class="o">+</span> <span class="nx">response</span><span class="p">.</span><span class="nx">bitSize</span><span class="p">);</span>

    <span class="c1">//# Get the UID of the card</span>
    <span class="nx">response</span> <span class="o">=</span> <span class="nx">mfrc522</span><span class="p">.</span><span class="nx">getUid</span><span class="p">();</span>
    <span class="k">if</span> <span class="p">(</span><span class="o">!</span><span class="nx">response</span><span class="p">.</span><span class="nx">status</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">UID Scan Error</span><span class="dl">"</span><span class="p">);</span>
        <span class="k">return</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="c1">//# If we have the UID, continue</span>
    <span class="kd">const</span> <span class="nx">uid</span> <span class="o">=</span> <span class="nx">response</span><span class="p">.</span><span class="nx">data</span><span class="p">;</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Card read UID: %s %s %s %s</span><span class="dl">"</span><span class="p">,</span> <span class="nx">uid</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="nx">toString</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span> <span class="nx">uid</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="nx">toString</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span> <span class="nx">uid</span><span class="p">[</span><span class="mi">2</span><span class="p">].</span><span class="nx">toString</span><span class="p">(</span><span class="mi">16</span><span class="p">),</span> <span class="nx">uid</span><span class="p">[</span><span class="mi">3</span><span class="p">].</span><span class="nx">toString</span><span class="p">(</span><span class="mi">16</span><span class="p">));</span>

    <span class="c1">//# Select the scanned card</span>
    <span class="kd">const</span> <span class="nx">memoryCapacity</span> <span class="o">=</span> <span class="nx">mfrc522</span><span class="p">.</span><span class="nx">selectCard</span><span class="p">(</span><span class="nx">uid</span><span class="p">);</span>
    <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Card Memory Capacity: </span><span class="dl">"</span> <span class="o">+</span> <span class="nx">memoryCapacity</span><span class="p">);</span>

    <span class="c1">//# dump fifo buffer</span>
    <span class="kd">let</span> <span class="nx">cardMemory</span> <span class="o">=</span> <span class="p">{};</span>
    <span class="k">for</span> <span class="p">(</span><span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">45</span><span class="p">;</span> <span class="nx">i</span><span class="o">++</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">!=</span> <span class="mi">44</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">cardMemory</span><span class="p">[</span><span class="s2">`block-</span><span class="p">${</span><span class="nx">i</span><span class="p">}</span><span class="s2">`</span><span class="p">]</span> <span class="o">=</span> <span class="nx">mfrc522</span><span class="p">.</span><span class="nx">getDataForBlock</span><span class="p">(</span><span class="nx">i</span><span class="p">).</span><span class="nx">toString</span><span class="p">().</span><span class="nx">split</span><span class="p">(</span><span class="dl">"</span><span class="s2">,</span><span class="dl">"</span><span class="p">).</span><span class="nx">map</span><span class="p">(</span><span class="nx">i</span> <span class="o">=&gt;</span> <span class="nb">String</span><span class="p">.</span><span class="nx">fromCharCode</span><span class="p">(</span><span class="nx">i</span><span class="p">)).</span><span class="nx">join</span><span class="p">(</span><span class="dl">"</span><span class="s2">,</span><span class="dl">"</span><span class="p">).</span><span class="nx">replace</span><span class="p">(</span><span class="sr">/</span><span class="se">\\</span><span class="sr">u</span><span class="se">[</span><span class="sr">0-9a-zA-Z</span><span class="se">]</span><span class="sr">+/</span><span class="p">,</span> <span class="dl">''</span><span class="p">);</span>
        <span class="p">}</span>

        <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Block: </span><span class="dl">"</span> <span class="o">+</span> <span class="nx">i</span> <span class="o">+</span> <span class="dl">"</span><span class="s2"> Data: </span><span class="dl">"</span> <span class="o">+</span> <span class="nx">mfrc522</span><span class="p">.</span><span class="nx">getDataForBlock</span><span class="p">(</span><span class="nx">i</span><span class="p">));</span>
    <span class="p">}</span>
<span class="p">},</span> <span class="mi">2000</span><span class="p">);</span>
</code></pre></div></div>

<h4 id="2-extracting-our-nfc-tag-data">2. Extracting our NFC Tag Data</h4>

<p>Since we do not want everything being extracted, we are just going to specify what we need for our tags. Looking into the result from the democode above shows us that our data is located in Block 7 and that it has a closing byte to show when all the data was delivered.</p>

<p>We can this add the following code to detect this:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">// Get out block (i = 7)</span>
<span class="kd">let</span> <span class="nx">blockNo</span> <span class="o">=</span> <span class="mi">7</span><span class="p">;</span>
<span class="kd">let</span> <span class="nx">blockClosingByte</span> <span class="o">=</span> <span class="mi">254</span><span class="p">;</span>

<span class="kd">let</span> <span class="nx">blockRaw</span> <span class="o">=</span> <span class="nx">mfrc522</span><span class="p">.</span><span class="nx">getDataForBlock</span><span class="p">(</span><span class="nx">blockNo</span><span class="p">).</span><span class="nx">toString</span><span class="p">().</span><span class="nx">split</span><span class="p">(</span><span class="dl">"</span><span class="s2">,</span><span class="dl">"</span><span class="p">);</span>
<span class="kd">let</span> <span class="nx">result</span> <span class="o">=</span> <span class="dl">""</span><span class="p">;</span>
<span class="kd">let</span> <span class="nx">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>

<span class="k">while</span> <span class="p">(</span><span class="nx">blockRaw</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">&amp;&amp;</span> <span class="nx">blockRaw</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">!=</span> <span class="dl">"</span><span class="s2">0</span><span class="dl">"</span> <span class="o">&amp;&amp;</span> <span class="nx">blockRaw</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">!=</span> <span class="nx">blockClosingByte</span><span class="p">.</span><span class="nx">toString</span><span class="p">()</span> <span class="o">&amp;&amp;</span> <span class="nx">i</span> <span class="o">&lt;</span> <span class="mi">20</span><span class="p">)</span> <span class="p">{</span>
    <span class="nx">i</span><span class="o">++</span><span class="p">;</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">i</span> <span class="o">==</span> <span class="mi">0</span> <span class="o">||</span> <span class="nx">i</span> <span class="o">==</span> <span class="mi">1</span> <span class="o">||</span> <span class="nx">blockRaw</span><span class="p">[</span><span class="nx">i</span><span class="p">]</span> <span class="o">==</span> <span class="nx">blockClosingByte</span><span class="p">.</span><span class="nx">toString</span><span class="p">())</span> <span class="p">{</span>
        <span class="c1">// Do nothing</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nx">result</span> <span class="o">+=</span> <span class="nb">String</span><span class="p">.</span><span class="nx">fromCharCode</span><span class="p">(</span><span class="nx">blockRaw</span><span class="p">[</span><span class="nx">i</span><span class="p">]);</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div></div>

<h4 id="3-sending-our-data-to-event-hub">3. Sending our data to Event Hub</h4>

<p>The last part to do now is to include our EventHub connection and send the message once a message has been detected. Through the awesome <code class="highlighter-rouge">azure-event-hubs</code> NPM package we are able to run the following code:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">const</span> <span class="nx">eventHubClient</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="dl">'</span><span class="s1">azure-event-hubs</span><span class="dl">'</span><span class="p">).</span><span class="nx">Client</span><span class="p">;</span>
<span class="kd">const</span> <span class="nx">client</span> <span class="o">=</span> <span class="nx">eventHubClient</span><span class="p">.</span><span class="nx">fromConnectionString</span><span class="p">(</span><span class="nx">config</span><span class="p">.</span><span class="nx">getConnectionString</span><span class="p">(),</span> <span class="nx">config</span><span class="p">.</span><span class="nx">eventHub</span><span class="p">);</span>
<span class="kd">const</span> <span class="nx">sender</span> <span class="o">=</span> <span class="k">await</span> <span class="nx">client</span><span class="p">.</span><span class="nx">createSender</span><span class="p">();</span>

<span class="nx">sender</span><span class="p">.</span><span class="nx">send</span><span class="p">({</span>
    <span class="na">name</span><span class="p">:</span> <span class="nx">process</span><span class="p">.</span><span class="nx">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">||</span> <span class="nx">result</span><span class="p">,</span>
    <span class="na">raw</span><span class="p">:</span> <span class="nx">blockRaw</span>
<span class="p">});</span>
</code></pre></div></div>

<p>Which will configure our sender its connection string as defined in a <code class="highlighter-rouge">config.js</code> that we created and connect to the given eventHub. After that we will just send a message containing our block details that we extracted through the code in step 2.</p>

<h3 id="website-code">Website Code</h3>

<h4 id="1-creating-the-base-website-layout">1. Creating the base website layout</h4>

<p>For the layout of the website, I decided to start from the design presented by the original Minecraft website <a href="https://minecraft.net/en-us/">https://minecraft.net/en-us/</a> which is very recognizable and easy to recreate using css and html, in just a few lines of codes we can get to this result:</p>

<p><img src="/assets/images/posts/minecraft-nfc/website-start.png" alt="/assets/images/posts/minecraft-nfc/website-start.png" /></p>

<h4 id="2-getting-the-incoming-data-from-event-hub">2. Getting the incoming data from Event Hub</h4>

<p>Once the website base template is made, we need to hook it up to our EventHub. For this I reused my previous <a href="/amqp-in-browser">work</a> that explains how you can easily hook your website to Event Hub and consume the events coming in through the AMQP protocol.</p>

<h4 id="3-displaying-our-picture">3. Displaying our picture</h4>

<p>Now we have our events coming in, we just have to add these few lines of code to process the events and update our HTML tree to show a picture:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">decodedMessage</span> <span class="o">=</span> <span class="nx">Utf8ArrayToStr</span><span class="p">(</span><span class="nx">context</span><span class="p">.</span><span class="nx">message</span><span class="p">.</span><span class="nx">body</span><span class="p">.</span><span class="nx">content</span><span class="p">);</span>
<span class="kd">var</span> <span class="nx">decodedMessages</span> <span class="o">=</span> <span class="nx">decodedMessage</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="dl">'</span><span class="se">\n</span><span class="dl">'</span><span class="p">);</span> <span class="c1">// Apparently multiple json messages per payload</span>
<span class="kd">var</span> <span class="nx">decodedMessage</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="nx">decodedMessages</span><span class="p">[</span><span class="mi">0</span><span class="p">]);</span>

<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="dl">"</span><span class="s2">Got Message: </span><span class="dl">"</span><span class="p">);</span>
<span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">decodedMessage</span><span class="p">);</span>

<span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">"</span><span class="s2">#content</span><span class="dl">"</span><span class="p">).</span><span class="nx">innerHTML</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">&lt;img id=</span><span class="se">\"</span><span class="s2">minecraft</span><span class="se">\"</span><span class="s2"> /&gt;</span><span class="dl">"</span><span class="p">;</span>
<span class="nb">document</span><span class="p">.</span><span class="nx">querySelector</span><span class="p">(</span><span class="dl">"</span><span class="s2">#minecraft</span><span class="dl">"</span><span class="p">).</span><span class="nx">src</span> <span class="o">=</span> <span class="dl">"</span><span class="s2">/images/dolls/</span><span class="dl">"</span> <span class="o">+</span> <span class="nx">decodedMessage</span><span class="p">.</span><span class="nx">name</span> <span class="o">+</span> <span class="dl">"</span><span class="s2">.png</span><span class="dl">"</span><span class="p">;</span>
</code></pre></div></div>

<h4 id="result">Result</h4>

<p>When done successfully we are now able to put a doll on the NFC reader which will present us with the following screen:</p>

<p><img src="/assets/images/posts/minecraft-nfc/website-doll.png" alt="/assets/images/posts/minecraft-nfc/website-doll.png" /></p>

<p>Allowing the children to play around with the tags to match the different dolls to these tags.</p>

<p>If you want to replicate this, feel free to check out the code at: <a href="https://github.com/thebillkidy/PublicProjects">https://github.com/thebillkidy/PublicProjects</a></p>

                </div>
            </section>

            <!-- Email subscribe form at the bottom of the page -->
            

            <footer class="post-full-footer">
                <!-- Everything inside the #author tags pulls data from the author -->
                <!-- #author-->
                
                    
                        <section class="author-card">
                            
                                <img class="author-profile-image" src="/assets/images/avatar.jpg" alt="xavier" />
                            
                            <section class="author-card-content">
                                <h4 class="author-card-name"><a href="/author/xavier">Xavier Geerinck</a></h4>
                                
                                    <p>Xavier works as a Cloud Solution Architect at Microsoft, helping its customer unlock the full potential of the cloud. Even though he is still considered a young graduate, he achieved his first success at the age 16, by creating and selling his first startup. He then took this knowledge to create and help more startups in different markets such as technology, social media, philanthropy and home care. While in the meantime gaining more enterprise insights at renowned enterprises such as Nokia, Cisco and now Microsoft.</p>
                                
                            </section>
                        </section>
                        <div class="post-full-footer-right">
                            <a class="author-card-button" href="/author/xavier">Read More</a>
                        </div>
                    
                
                <!-- /author  -->
            </footer>

            <!-- If you use Disqus comments, just uncomment this block.
            The only thing you need to change is "test-apkdzgmqhj" - which
            should be replaced with your own Disqus site-id. -->
            
                <section class="post-full-comments">
                    <div id="disqus_thread"></div>
                    <script>
                        var disqus_config = function () {
                            this.page.url = window.location.href;
                            this.page.identifier = '/minecraft-rfc-scanner';
                        };
                        (function() {
                            var d = document, s = d.createElement('script');
                            s.src = 'https://xaviergeerinck.disqus.com/embed.js';
                            s.setAttribute('data-timestamp', +new Date());
                            (d.head || d.body).appendChild(s);
                        })();
                    </script>
                </section>
            

        </article>

    </div>
</main>

<!-- Links to Previous/Next posts -->
<aside class="read-next outer">
    <div class="inner">
        <div class="read-next-feed">
            
                
                
                
                
                    <article class="read-next-card"
                        
                            style="background-image: url(/assets/images/covers/blog-cover.png)"
                        
                    >
                        <header class="read-next-card-header">
                            <small class="read-next-card-header-sitetitle">&mdash; Xavier Geerinck - Blog &mdash;</small>
                            
                                <h3 class="read-next-card-header-title"><a href="/tag/coding/">Coding</a></h3>
                            
                        </header>
                        <div class="read-next-divider"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 14.5s2 3 5 3 5.5-2.463 5.5-5.5S21 6.5 18 6.5c-5 0-7 11-12 11C2.962 17.5.5 15.037.5 12S3 6.5 6 6.5s4.5 3.5 4.5 3.5"/></svg>
</div>
                        <div class="read-next-card-content">
                            <ul>
                                
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/azure-automated-container-push">Create a script to deploy a container automatically with Azure Container Registry</a></li>
                                        
                                    
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/stream-sampling">Sampling a real-time stream</a></li>
                                        
                                    
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                    
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                            <li><a href="/getting-tweets">Getting Tweets of multiple people on Twitter</a></li>
                                        
                                    
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                                  
                                    
                                        
                                        
                                    
                                  
                                
                            </ul>
                        </div>
                        <footer class="read-next-card-footer">
                            <a href="/tag/coding/">
                                
                                    See all 30 posts  →
                                
                            </a>
                        </footer>
                    </article>
                
            

            <!-- If there's a previous post, display it using the same markup included from - partials/post-card.hbs -->
            
                
    <article class="post-card post-template">
        
            <a class="post-card-image-link" href="/big-data-architectures">
                <div class="post-card-image" style="background-image: url(/assets/images/covers/bigdata2.jpeg)"></div>
            </a>
        
        <div class="post-card-content">
            <a class="post-card-content-link" href="/big-data-architectures">
                <header class="post-card-header">
                    
                        
                            
                                <span class="post-card-tags">Big-data</span>
                            
                        
                    

                    <h2 class="post-card-title">Big Data, the why, how and what - A thought Process and Architecture</h2>
                </header>
                <section class="post-card-excerpt">
                    <p>One of the most common questions I get when talking with customers, is how they are able to set up a good big data architecture that will allow them to process all their</p>
                </section>
            </a>
            <footer class="post-card-meta">
                
                    
                        
                        <img class="author-profile-image" src="/assets/images/avatar.jpg" alt="Xavier Geerinck" />
                        
                        <span class="post-card-author">
                            <a href="/author/xavier/">Xavier Geerinck</a>
                        </span>
                    
                
            </footer>
        </div>
    </article>

            

            <!-- If there's a next post, display it using the same markup included from - partials/post-card.hbs -->
            
                
    <article class="post-card post-template">
        
            <a class="post-card-image-link" href="/rl-overview-terminology">
                <div class="post-card-image" style="background-image: url(/assets/images/covers/rl.jpg)"></div>
            </a>
        
        <div class="post-card-content">
            <a class="post-card-content-link" href="/rl-overview-terminology">
                <header class="post-card-header">
                    
                        
                            
                               <span class="post-card-tags">Ai</span>
                            
                        
                            
                               <span class="post-card-tags">Ai-ml</span>
                            
                        
                            
                                <span class="post-card-tags">Ai-rl</span>
                            
                        
                    

                    <h2 class="post-card-title">Reinforcement Learning - Terminology</h2>
                </header>
                <section class="post-card-excerpt">
                    <p>Tags: Machine LearningReinforcement LearningQ LearningArtificial IntelligenceMonte Carlo # Reinforcement Learning - An Overview of Today Reinforcement Learning took big leaps recently, so big that they are being used more and more in production</p>
                </section>
            </a>
            <footer class="post-card-meta">
                
                    
                        
                        <img class="author-profile-image" src="/assets/images/avatar.jpg" alt="Xavier Geerinck" />
                        
                        <span class="post-card-author">
                            <a href="/author/xavier/">Xavier Geerinck</a>
                        </span>
                    
                
            </footer>
        </div>
    </article>

            
        </div>
    </div>
</aside>

<!-- Floating header which appears on-scroll, included from includes/floating-header.hbs -->
<div class="floating-header">
    <div class="floating-header-logo">
        <a href="/">
            
                <img src="/assets/images/favicon.png" alt="Xavier Geerinck - Blog icon" />
            
            <span>Xavier Geerinck - Blog</span>
        </a>
    </div>
    <span class="floating-header-divider">&mdash;</span>
    <div class="floating-header-title">Building a Minecraft Puppet Scanner with Event Hub, a NFC 522 Reader and a Raspberry PI</div>
    <div class="floating-header-share">
        <div class="floating-header-share-label">Share this <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
    <path d="M7.5 15.5V4a1.5 1.5 0 1 1 3 0v4.5h2a1 1 0 0 1 1 1h2a1 1 0 0 1 1 1H18a1.5 1.5 0 0 1 1.5 1.5v3.099c0 .929-.13 1.854-.385 2.748L17.5 23.5h-9c-1.5-2-5.417-8.673-5.417-8.673a1.2 1.2 0 0 1 1.76-1.605L7.5 15.5zm6-6v2m-3-3.5v3.5m6-1v2"/>
</svg>
</div>
        <a class="floating-header-share-tw" href="https://twitter.com/share?text=Building+a+Minecraft+Puppet+Scanner+with+Event+Hub%2C+a+NFC+522+Reader+and+a+Raspberry+PI&amp;url=https://thebillkidy.github.io/minecraft-rfc-scanner"
            onclick="window.open(this.href, 'share-twitter', 'width=550,height=235');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M30.063 7.313c-.813 1.125-1.75 2.125-2.875 2.938v.75c0 1.563-.188 3.125-.688 4.625a15.088 15.088 0 0 1-2.063 4.438c-.875 1.438-2 2.688-3.25 3.813a15.015 15.015 0 0 1-4.625 2.563c-1.813.688-3.75 1-5.75 1-3.25 0-6.188-.875-8.875-2.625.438.063.875.125 1.375.125 2.688 0 5.063-.875 7.188-2.5-1.25 0-2.375-.375-3.375-1.125s-1.688-1.688-2.063-2.875c.438.063.813.125 1.125.125.5 0 1-.063 1.5-.25-1.313-.25-2.438-.938-3.313-1.938a5.673 5.673 0 0 1-1.313-3.688v-.063c.813.438 1.688.688 2.625.688a5.228 5.228 0 0 1-1.875-2c-.5-.875-.688-1.813-.688-2.75 0-1.063.25-2.063.75-2.938 1.438 1.75 3.188 3.188 5.25 4.25s4.313 1.688 6.688 1.813a5.579 5.579 0 0 1 1.5-5.438c1.125-1.125 2.5-1.688 4.125-1.688s3.063.625 4.188 1.813a11.48 11.48 0 0 0 3.688-1.375c-.438 1.375-1.313 2.438-2.563 3.188 1.125-.125 2.188-.438 3.313-.875z"/></svg>

        </a>
        <a class="floating-header-share-fb" href="https://www.facebook.com/sharer/sharer.php?u=https://thebillkidy.github.io/minecraft-rfc-scanner"
            onclick="window.open(this.href, 'share-facebook','width=580,height=296');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32"><path d="M19 6h5V0h-5c-3.86 0-7 3.14-7 7v3H8v6h4v16h6V16h5l1-6h-6V7c0-.542.458-1 1-1z"/></svg>

        </a>
        <a class="floating-header-share-li" href="https://www.linkedin.com/shareArticle?mini=true&url=https://thebillkidy.github.io/minecraft-rfc-scanner&title=Building+a+Minecraft+Puppet+Scanner+with+Event+Hub%2C+a+NFC+522+Reader+and+a+Raspberry+PI&source=https://thebillkidy.github.io/"
            onclick="window.open(this.href, 'share-linkedin','width=580,height=296');return false;">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M19 0h-14c-2.761 0-5 2.239-5 5v14c0 2.761 2.239 5 5 5h14c2.762 0 5-2.239 5-5v-14c0-2.761-2.238-5-5-5zm-11 19h-3v-11h3v11zm-1.5-12.268c-.966 0-1.75-.79-1.75-1.764s.784-1.764 1.75-1.764 1.75.79 1.75 1.764-.783 1.764-1.75 1.764zm13.5 12.268h-3v-5.604c0-3.368-4-3.113-4 0v5.604h-3v-11h3v1.765c1.396-2.586 7-2.777 7 2.476v6.759z"/></svg>
        </a>
    </div>
    <progress class="progress" value="0">
        <div class="progress-container">
            <span class="progress-bar"></span>
        </div>
    </progress>
</div>


<!-- /post -->

<!-- The #contentFor helper here will send everything inside it up to the matching #block helper found in default.hbs -->


        <!-- Previous/next page links - displayed on every page -->
        

        <!-- The footer at the very bottom of the screen -->
        <footer class="site-footer outer">
            <div class="site-footer-content inner">
                <section class="copyright"><a href="/">Xavier Geerinck - Blog</a> &copy; 2020</section>
                <section class="poweredby">Made with ❤ in Belgium</section>
                <nav class="site-footer-nav">
                    <a href="/">Latest Posts</a>
                    
                    <a href="https://twitter.com/XavierGeerinck" target="_blank" rel="noopener">Twitter</a>
                    <a href="https://linkedin.com/in/xaviergeerinck" target="_blank" rel="noopener">LinkedIn</a>
                </nav>
            </div>
        </footer>
    </div>

    <!-- The big email subscribe modal content -->
     

    <!-- highlight.js -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/scala.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/languages/yaml.min.js"></script>
    <!-- <script>hljs.initHighlightingOnLoad();</script> -->

    <script>
        var blocks = document.querySelectorAll('div[class^=language-]');
        blocks.forEach((b) => {
            var language = b.className.split(" ")[0].match(/language\-(.*)/)[1];

            var codeBlocks = b.querySelectorAll('pre code');

            // Highlight the code
            codeBlocks.forEach((i) => {
                var text = i.innerText;
                var highlightedText = hljs.highlight(language, text);
                i.innerHTML = highlightedText.value;
            });

            // Add line numbers

            codeBlocks.forEach((i) => {            
                i.innerHTML = i.innerHTML.split("\n").map(function (i, idx, arr) {
                    // The last line seems to be empty, so don't work with it
                    if (idx == arr.length - 1) {
                        return '';
                    }

                    return '<span class="line-numbers"">' + i + '</span>' + "\n";
                }).join("");
            });
        });
    </script>

    <!-- jQuery + Fitvids, which makes all video embeds responsive -->
    <script
        src="https://code.jquery.com/jquery-3.3.1.min.js"
        integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
        crossorigin="anonymous"></script>
    <script type="text/javascript" src="/assets/js/jquery.fitvids.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/fitvids/1.2.0/jquery.fitvids.min.js"></script>


    <!-- Paginator increased to "infinit" in _config.yml -->
    <!-- if paginator.posts  -->
    <!-- <script>
        var maxPages = parseInt('');
    </script>
    <script src="/assets/js/infinitescroll.js"></script> -->
    <!-- /endif -->

    


    <!-- Add Google Analytics  -->
    <!-- Google Analytics Tracking code -->
 <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-27398198-1', 'auto');
  ga('send', 'pageview');

 </script>


    <!-- The #block helper will pull in data from the #contentFor other template files. In this case, there's some JavaScript which we only want to use in post.hbs, but it needs to be included down here, after jQuery has already loaded. -->
    
        <script>

// NOTE: Scroll performance is poor in Safari
// - this appears to be due to the events firing much more slowly in Safari.
//   Dropping the scroll event and using only a raf loop results in smoother
//   scrolling but continuous processing even when not scrolling
$(document).ready(function () {
    // Start fitVids
    var $postContent = $(".post-full-content");
    $postContent.fitVids();
    // End fitVids

    var progressBar = document.querySelector('progress');
    var header = document.querySelector('.floating-header');
    var title = document.querySelector('.post-full-title');

    var lastScrollY = window.scrollY;
    var lastWindowHeight = window.innerHeight;
    var lastDocumentHeight = $(document).height();
    var ticking = false;

    function onScroll() {
        lastScrollY = window.scrollY;
        requestTick();
    }

    function onResize() {
        lastWindowHeight = window.innerHeight;
        lastDocumentHeight = $(document).height();
        requestTick();
    }

    function requestTick() {
        if (!ticking) {
            requestAnimationFrame(update);
        }
        ticking = true;
    }

    function update() {
        var trigger = title.getBoundingClientRect().top + window.scrollY;
        var triggerOffset = title.offsetHeight + 35;
        var progressMax = lastDocumentHeight - lastWindowHeight;

        // show/hide floating header
        if (lastScrollY >= trigger + triggerOffset) {
            header.classList.add('floating-active');
        } else {
            header.classList.remove('floating-active');
        }

        progressBar.setAttribute('max', progressMax);
        progressBar.setAttribute('value', lastScrollY);

        ticking = false;
    }

    window.addEventListener('scroll', onScroll, {passive: true});
    window.addEventListener('resize', onResize, false);

    update();
});
</script>

    

</body>
</html>
